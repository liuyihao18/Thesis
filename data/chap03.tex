% !TeX root = ../thuthesis-example.tex

\chapter{信号处理方法}

\section{感知模型的挑战}

上一章中详细介绍了本文所采用的感知模型，目标物体的运动将改变反射信号的特征，包括幅度和相位信息，而使用这些信息，便可以推出感知目标的运动状态。
理想情况下，信号幅度$\Delta A \propto \alpha_1'(\Delta \tau_1) \cdot \alpha_2(\Delta \tau_2)$，相位$\Delta \varphi \propto 2 \pi f_c \left(\Delta \tau_1 + \Delta \tau_2\right)$。
通过幅度信息，可以推导出目标物体的运动频率，但是由于$\alpha_1'(\Delta \tau_1)$和$\alpha_2(\Delta \tau_2)$均为非线性函数，
因此难以推导出目标物体的运动幅度，只能作为一个大致的参考。
而通过相位信息，可以直接推导出目标物体的运动幅度和频率，因此相位信息在感知过程中起着至关重要的作用。

然而，在实际应用中，受硬件缺陷、环境噪声等多种因素影响，感知信号往往存在误差，导致相位信息难以准确提取，从而影响最终的感知效果。
本章节的目标就是在这种复杂情况下，通过一系列有效的信号处理方法，准确地从接收端收到的信号中提取出反射信号$\hat{H}_B$，并消除其他误差干扰，最后准确推断出目标物体的运动信息。

具体而言，本章将解决以下几个关键挑战：

（1）\textbf{信号能量分散}。
反向散射信号由于传播距离长、反射截面小等原因，信号能量本身较弱。
而LoRa技术的标准解调方法会使得信号能量分散为两部分，从而造成能量损失，降低信噪比，影响信号特征的提取。
如果能够将两部分的信号能量集中在一起，那么就可以最大化信号的信噪比，从而更准确地提取出信号特征。
为此，本章提出了一种基于共轭解调的能量集中方法与一种基于概率模型的相干解调方案，来解决这个问题。

（2）\textbf{远近效应}。
虽然正交感知模型保证了能够有效地区分不同频率的目标信号，但是信号在实际场景中仍然可能遇到远近效应的问题。
远近效应是指，由于两个目标物体距离接收端的远近不同，导致其信号强度差距过大。
换句话说，在公式\eqref{eq:orthogonal_extract}中，虽然积分项趋近于零，但是由于$A_2 \gg A_1$，最终的约等号并不成立，强信号仍然会干扰到弱信号的提取。
在傅里叶变换后的图像上，则是呈现出强信号的旁瓣影响甚至掩盖弱信号的主瓣。
为此，本章提出了一种基于窗函数的远近效应缓解方法，来适应这一挑战。

（3）\textbf{收发端不同步}。
收发端不同步主要是指由于发送端和接收端之间的时钟不同步，导致接收信号的相位发生偏移。
这类偏移主要表现在载波频率偏移（CFO）、采样时间偏移（STO）和采样频率偏移（SFO）上，从而影响相位信息的准确提取。
过去的工作常常采用有线同步的方法来解决这个问题，但是这在实际场景中并不适用，尤其是当收发端的距离较远时。
有些工作转而采用接收端多天线的方法来消除相位偏移，但是这也增加了系统的复杂度和成本。
为此，本章提出了一种利用现成静态激励信号对动态反射信号进行相位校正的方法，无需额外的硬件支持。

（4）\textbf{标签频率漂移}。
标签的频率漂移主要是指由于标签的频移频率$f_{\text{tag}}$不稳定，导致反射信号的相位出现漂移。
这在低成本标签中尤为明显，因为其晶振精度较低，且容易受到温度、湿度等环境因素的影响。
许多工作采用高精度晶振来减小频率漂移，但是这也增加了标签的成本和功耗，不利于标签的大规模部署应用。
为此，本章提出了一种利用反向散射信号双边带的特性进行误差消除的方法，对廉价的标签同样适用。

在本章的最后，还将提出一种感知信息提取方法，综合利用幅度和相位信息来估计目标物体的运动状态，并对所提出的感知模型进行抗干扰能力分析，验证其在复杂环境下的有效性。

\section{信号能量集中方法}

为了解决信号能量分散的问题，本节将提出两种能量集中方法来提高信号的信噪比。
在~\ref{sec:chirp}节中介绍了啁啾信号的基本原理，LoRa标准解调方法会将接收到的啁啾信号与本地生成的下啁啾信号相乘，然后执行傅里叶变换，最终获得啁啾信号的初始频率。
在这个过程中，由于啁啾信号的频率卷绕特性，接收信号被转换为两段不连续的正弦信号，频率分别为 $f_0 + \frac{BW}{2}$ 和 $f_0 - \frac{BW}{2}$。
虽然在接收端采样频率等于啁啾信号带宽的情况下，这两个正弦信号会因为混叠现象而在快速傅里叶变换的结果中产生同一个峰值（即使因为频率卷绕点相位不连续而产生频谱泄漏），但是在本文的反向散射系统中，为了接收来自频移键控标签的信号，接收端的采样频率需要大于啁啾信号的带宽，从而这两个正弦信号不会发生混叠。

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.6\linewidth]{chap03/double_peak.pdf}
    \caption{啁啾标准解调结果}
    \label{fig:double_peak}
\end{figure}

如图~\ref{fig:double_peak}~所示，普通啁啾解调后，信号能量分散为两部分，从而造成能量损失。
虽然这个能量损失对于激励信号来说影响不大，但是对于目标弱反射信号来说，会显著影响信号特征的提取。

\subsection{共轭解调方法}

本节提出的第一种能量集中方法是基于共轭解调的方案。
该方法的核心思想是利用强激励信号的捕获效应，得到啁啾信号的参数，然后构造啁啾信号的共轭版本，与接收信号相乘，从而将两部分的信号能量集中在一起。
啁啾信号的共轭版本可以表示为：
\begin{equation}
    s^*(t) =
    \begin{cases}
        e^{-j2\pi\left(f_0 t + \frac{1}{2}kt^2\right)},\ t \in [0, t_\text{wrap}) \\
        e^{-j2\pi\left(-\frac{BW}{2} (t - t_\text{wrap}) + \frac{1}{2}k(t-t_\text{wrap})^2\right)},\ t \in [t_\text{wrap}, T)
    \end{cases}
\end{equation}

将其与接收端收到的组合信号相乘后，便可以得到：
\begin{equation}
    \begin{aligned}
        r(t) \cdot s^*(t) & = A_E e^{j \varphi_E}                                                                          \\
                          & + e^{j 2\pi f_\text{tag} t} \cdot A_B^\text{upper}e^{j\varphi_B^\text{upper}}                  \\
                          & + e^{-j 2\pi f_\text{tag} t} \cdot A_B^\text{lower}e^{j\varphi_B^\text{lower}} ,\ t \in [0, T)
    \end{aligned}
\end{equation}

这里的三项分别对应了公式~\eqref{eq:H_E}、\eqref{eq:H_B_upper}~和~\eqref{eq:H_B_lower}~中的相量，也是本文所关注的信号成分。
如图~\ref{fig:single_peak}~所示，经过共轭解调后，啁啾信号的两部分能量被集中在了一起，从而最大化了信号的信噪比，提升了信号特征的提取效果。

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.6\linewidth]{chap03/single_peak.pdf}
    \caption{啁啾共轭解调结果}
    \label{fig:single_peak}
\end{figure}

值得注意的是，由于硬件的缺陷，啁啾信号频率卷绕处会出现相位不连续的问题，从而导致频谱泄漏现象，影响信号的解调效果。
这个问题可以通过搜索的方法来缓解，即在频率卷绕点附近搜索最佳的相位补偿值，从而最大化信号的能量集中效果。
然而，搜索的方法终究效果有限，因此本文还提出了一种基于概率模型的相干解调方案，来进一步提升信号的解调效果。

\subsection{相干解调方法}

该方法源于LoRa通讯相关的工作~\cite{du2024loratrimmer}，其核心在于通过概率建模推导出了分段啁啾信号处理的最优方法，从而提供一个更准确的信号参数估计与相位估计。

给定起始频率$f_0 = f$，在~\ref{sec:chirp}节中推导了频率卷绕位置$t_\text{wrap}$与其的关系：
\begin{equation}
    t_\text{wrap}(f) = T \cdot \left(\frac{1}{2} - \frac{f}{BW}\right)
\end{equation}

于是，可以将信号$r(t)$分为两段进行处理，并分别进行快速傅里叶变换。对第一段信号，取出频点处$f+\frac{BW}{2}$的激励信号与频点$f+\frac{BW}{2}+f_\text{tag}$和$f+\frac{BW}{2}+f_\text{tag}$处的反射信号，分别记作：
\begin{equation}
    X_E(f)= \FFT[r(t)]\left(f + \frac{BW}{2}\right),\ t \in [0, t_\text{wrap}(f))
\end{equation}
\begin{equation}
    X_B^\text{upper}(f)= \FFT[r(t)]\left(f + \frac{BW}{2} + f_\text{tag}\right),\ t \in [0, t_\text{wrap}(f))
\end{equation}
\begin{equation}
    X_B^\text{lower}(f)= \FFT[r(t)]\left(f + \frac{BW}{2} - f_\text{tag}\right),\ t \in [0, t_\text{wrap}(f))
\end{equation}

对第二段信号，取出频点处$f-\frac{BW}{2}$的激励信号与频点$f-\frac{BW}{2}+f_\text{tag}$和$f-\frac{BW}{2}+f_\text{tag}$处的反射信号，分别记作：
\begin{equation}
    Y_E(f)= \FFT[r(t)]\left(f - \frac{BW}{2}\right),\ t \in [t_\text{wrap}(f), T)
\end{equation}
\begin{equation}
    Y_B^\text{upper}(f)= \FFT[r(t)]\left(f - \frac{BW}{2} + f_\text{tag}\right),\ t \in [t_\text{wrap}(f), T)
\end{equation}
\begin{equation}
    Y_B^\text{lower}(f)= \FFT[r(t)]\left(f - \frac{BW}{2} - f_\text{tag}\right),\ t \in [t_\text{wrap}(f), T)
\end{equation}

最终，可以得到：
\begin{equation}
    \hat{f_0} = \argmax_f \left| X(f) \right|^2 + \left| Y(f) \right|^2
\end{equation}

通常情况下，由于激励信号的能量远大于反射信号，因此仅使用激励信号便可以得到$f_0$的估计结果。
另一方面，反向散射信号的估计结果也可以作为一个辅助参考，从而提升估计的准确性。
在得到$f_0$的估计结果后，便可以更精准地估计出前后两段信号的相位补偿值。

该方法能够在极低的信噪比下准确估计出啁啾信号的起始频率$f_0$，从而提升信号的解调效果，但是其代价在于计算复杂度的提升。
该方法的时间复杂度是$O\left(n^2\right)$，而普通的啁啾解调方法的时间复杂度是$O\left(n \log n\right)$，因此在实时监测系统中难以应用。
但这不失为一种提升感知精度的有效手段，需要在应用实时性与感知精准度之间进行权衡。

\section{远近效应缓解方法}

为了解决远近效应的问题，本节提出了一种基于窗函数的远近效应缓解方法。
在标准傅里叶变换后，长度为$T$的信号，其主瓣宽度为$\frac{2}{T}$，旁瓣宽度是其一半，为$\frac{1}{T}$。
这与公式~\eqref{eq:orthogonal_extract}的含义一致，假设信号1与信号2能量相当，便有：1）当频率间隔$f_2 - f_1 = \frac{n}{T}, n \in \mathbb{Z} \setminus \{0\}$时，信号1的主瓣位于信号2旁瓣的零点，信号2对信号1无影响；2）当频率间隔$|f_2 - f_1| \gg \frac{1}{T}$时，信号1的主瓣高度远高于信号2的旁瓣高度，信号2对信号1的影响有限。

然而，在实际场景中，会出现信号1和信号2能量差距过大的情况。
若满足第一种条件，信号2对信号1仍然无影响\footnote{OFDM采用了类似的思想。}；但是在第二种条件下，信号2的旁瓣可能会干扰甚至掩盖信号1的主瓣，导致信号1无法被正确提取。
为了解决这个问题，本节提出对信号应用窗函数来降低旁瓣高度，从而抑制第二种条件下强信号2对弱信号1的干扰。

窗函数是一种在信号处理领域中常用的技术，通过对信号进行加权处理，能够改变其频谱特性，从而达到降低旁瓣高度的目的，相关内容已经在文献~\cite{ni2022understand}~中讨论。
常见的窗函数包括矩形窗、汉宁窗、汉明窗、布莱克曼窗等。
其中，汉明窗使信号幅度从中心向两侧平滑衰减，能够实现超过40dB的旁瓣抑制效果。

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.95\linewidth]{chap03/window.pdf}
    \caption{改进汉明窗的时域权重和频域响应}
    \label{fig:window}
\end{figure}

为了进一步增强远近效应的抑制效果，本研究借鉴文献~\cite{mottaghi2011new} 的方法，在汉明窗的基础上加入直流（DC）项和余弦函数的三次谐波。
这种改进使得窗函数在保持主瓣宽度不至于过度增加的情况下，使最大旁瓣高度可再降低约2至4.5dB。
改进汉明窗的时域权重和频域响应曲线如图~\ref{fig:window}~所示，相较于标准傅里叶变换（也就是矩形窗），旁瓣高度大幅降低。

\section{相位偏移消除方法}

硬件不完善导致的信号特征误差是感知系统中常见的问题，尤其是相位偏移，将完全阻碍感知应用。
在本文中，相位偏移主要来源于收发端不同步和标签频率漂移两种情况，本节将分别介绍针对这两种情况的相位偏移消除方法。

\subsection{非同步收发端的相位校正}

收发端不同步指的是发送端和接收端之间的时钟不同步，即发送端和接收端使用的是不同的参考时钟源。
于是，它们之间的相位偏移主要由以下三个因素导致：

\subsubsection{由CFO引起的偏移}
当发送端（TX）和接收端（RX）不同步时，它们生成的载波频率会有所不同，导致收发端载波相位之间出现差异。
假设载波频率偏移（CFO）在时间上保持恒定\footnote{即使CFO随时间变化，本文提出的方法仍然适用。}，那么相位偏移可表示为：
\begin{equation}
    \varepsilon_{\text{CFO}} = \varphi_{\text{TX}} - \varphi_{\text{RX}} =  2 \pi f_{\text{CFO}} t
\end{equation}

\subsubsection{由STO引起的偏移}
由于接收端采样频率$fs$是有限的，因此接收端在接收信号时无法精确采样到啁啾信号的起始时间，导致窗口对齐时 $t_{\text{start}} \neq \tau$。
设时间偏移为 $t_{\text{STO}} = t_{\text{start}} - \tau, t_\text{STO} \in \left[-\frac{1}{2f_s}, \frac{1}{2f_s}\right)$，它将对每个啁啾信号在起始点产生相位偏移：
\begin{equation}
    \begin{aligned}
        \left. \varepsilon_{\text{STO}} \right|_{t = nT}
         & = s\left(nT + t_{\text{STO}}\right) - s(nT)       \\
         & = 2\pi f_0t_{\text{STO}} + \pi k t_{\text{STO}}^2
    \end{aligned}
    \label{eq:varphi_STO}
\end{equation}

其中，$s$是发送端发送的啁啾信号。
由于本文通过傅里叶变换来汇聚每个啁啾信号的能量，因此仅需关注每个啁啾信号起始点的相位偏移。

\subsubsection{由SFO引起的偏移}
当收发端不同步时，还会发生采样频率偏移（SFO），导致接收信号的时间乘以一个缩放因子$m$，其导致的相位偏移为：
\begin{equation}
    \begin{aligned}
        \varepsilon_{\text{SFO}}
         & = s(mt) - s(t)                                      \\
         & = 2\pi\left(f_0(m-1)t + \frac{1}{2}k(m-1)t^2\right)
    \end{aligned}
\end{equation}

\subsubsection{三种偏移对激励信号和反向散射信号的影响}
CFO、STO和SFO对激励信号和反向散射信号的综合影响可以表示为：
\begin{equation}
    \begin{aligned}
        \varepsilon_{E}
         & = 2 \pi f_{\text{CFO}} m(t + t_{\text{STO}})                  \\
         & \quad + s\left(m\left(t + t_{\text{STO}}\right)\right) - s(t)
    \end{aligned}
    \label{eq:varphi_E}
\end{equation}
\begin{equation}
    \begin{aligned}
        \varepsilon_{B}
         & = 2 \pi f_{\text{CFO}} m(t + t_{\text{STO}} + \tau_{\Delta})                  \\
         & \quad + s\left(m\left(t + t_{\text{STO}} + \tau_{\Delta}\right)\right) - s(t)
    \end{aligned}
    \label{eq:varphi_B}
\end{equation}

其中，$\tau_{\Delta} = \tau - \tau_1 - \tau_2$。
在实际场景中，接收端收取的激励信号和反向散射双边带信号可以分别表示为$\hat{H}_E = H_E \cdot e^{j\varepsilon_E}$、$\hat{H}^\text{upper}_B = H^\text{upper}_B \cdot e^{j\varepsilon_B}$和$\hat{H}^\text{lower}_B = H^\text{lower}_B \cdot e^{j\varepsilon_B}$。
考虑$\varepsilon_E$和$\varepsilon_B$的差值：
\begin{equation}
    \begin{aligned}
        \left. \varepsilon_{B} - \varepsilon_{E} \right|_{t = nT}
         & = 2 \pi (f_0 + f_{\text{CFO}}) m \tau_{\Delta}                 \\
         & \quad + \pi km^2\tau_{\Delta}(2t_{\text{STO}} + \tau_{\Delta}) \\
         & \approx 0
    \end{aligned}
\end{equation}

在上式中，$f_{\text{CFO}}$和$f_0$仅为几百kHz量级，$\tau_\Delta$仅为纳秒级，而这些项的变化量甚至更小，使得该差值的变化量近似为0。
为简便起见，在本文的分析中直接将该差值记作0。
于是，通过将反向散射信号除以激励信号，系统便能有效地校正由发送端和接收端之间不同步引入的相位偏移。

相除之后的信号可以表示为：
\begin{equation}
    \begin{aligned}
        H_\text{div}^\text{upper} & = \frac{\hat{H}^\text{upper}_B}{\hat{H}_E} = \frac{H^\text{upper}_B}{H_E} \cdot e^{j(\varepsilon_B - \varepsilon_E)}                                                   \\
                                  & \approx \frac{H^\text{upper}_B}{H_E} = \frac{\alpha_1'(\tau_1)\cdot\alpha_2(\tau_2)}{\alpha(\tau)} \cdot e^{j2\pi f_c\left(\tau - \left(\tau_1 + \tau_2\right)\right)} \\
                                  & \quad \quad \quad \quad \quad \cdot e^{j2\pi f_{\text{tag}} \left(\tau - \tau_2\right)} \cdot e^{j\psi_{\text{tag}}}                                                   \\
    \end{aligned}
\end{equation}
\begin{equation}
    \begin{aligned}
        H_\text{div}^\text{lower} & = \frac{\hat{H}^\text{lower}_B}{\hat{H}_E} = \frac{H^\text{lower}_B}{H_E} \cdot e^{j(\varepsilon_B - \varepsilon_E)}                                                   \\
                                  & \approx \frac{H^\text{lower}_B}{H_E} = \frac{\alpha_1'(\tau_1)\cdot\alpha_2(\tau_2)}{\alpha(\tau)} \cdot e^{j2\pi f_c\left(\tau - \left(\tau_1 + \tau_2\right)\right)} \\
                                  & \quad \quad \quad \quad \quad \cdot e^{-j2\pi f_{\text{tag}} \left(\tau - \tau_2\right)} \cdot e^{-j\psi_{\text{tag}}}                                                 \\
    \end{aligned}
\end{equation}

这个操作的核心在于激励信号和反向散射信号均由相同的收发端进行发送和接收，因此CFO、STO和SFO造成的偏移几乎是相同的，从而在信号相除时得以消除。
当有多个标签同时工作时，该方法仍然适用，只需分别将每个标签的反向散射信号与激励信号相除即可：
\begin{equation}
    H_{\text{div}_i}^\text{upper} = \frac{\hat{H}^\text{upper}_{B_i}}{\hat{H}_E},\quad H_{\text{div}_i}^\text{lower} = \frac{\hat{H}^\text{lower}_{B_i}}{\hat{H}_E}
\end{equation}

\subsection{标签频率漂移的误差消除}

标签频率漂移指的是由于标签的频移频率$f_{\text{tag}}$不稳定，导致反射信号的相位出现漂移。
这种漂移在低成本标签中更为明显，因为其晶振精度较低，且容易受到温度、湿度等环境因素的影响。
考虑$H_{\text{div}}^\text{upper}$和$H_{\text{div}}^\text{lower}$中与标签频率$f_{\text{tag}}$相关的相位项：
\begin{equation}
    \varepsilon_{\text{tag}}^\text{upper} = 2\pi f_{\text{tag}} \left(\tau - \tau_2\right) + \psi_{\text{tag}}
\end{equation}
\begin{equation}
    \varepsilon_{\text{tag}}^\text{lower} = -2\pi f_{\text{tag}} \left(\tau - \tau_2\right) - \psi_{\text{tag}}
\end{equation}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.95\linewidth]{chap03/backscatter.pdf}
    \caption{反向散射标签调制原理}
    \label{fig:backscatter}
\end{figure}

虽然上式中第1项由于$f_\text{tag}$只有几十kHz量级，而$\tau - \tau_2$只有纳秒级，使得其可忽略不计，但是第2项$\psi_{\text{tag}}$\footnote{$\Delta \psi_{\text{tag}} \approx 2 \pi \Delta f_\text{tag} \Delta t$可以作为一个量级上的估计。}会引入显著的相位偏移，从而影响感知精度。
为了解决这个问题，本文提出了一种利用反向散射信号双边带的特性进行误差消除的方法。
在~\ref{sec:backscatter}~节中，已经介绍了反向散射标签通过调制激励信号来生成双边带信号的原理，如图~\ref{fig:backscatter}~所示，标签生成一个频率为 $f$ 的方波，该方波可以在复数域中分解为两个频率分别为 $f$ 和 $-f$ 的正弦波。
于是，标签频率$f_\text{tag}$的漂移会同时影响这两个正弦波信号的相位，但是影响方向相反。
也就是说，有：
\begin{equation}
    \varepsilon_{\text{tag}}^\text{upper} + \varepsilon_{\text{tag}}^\text{lower} = 0
\end{equation}

因此，通过将双边带信号结合起来，便可以有效地消除标签频率漂移引起的相位误差：
\begin{equation}
    H^2_\text{div} = H_\text{div}^\text{upper} \cdot H_\text{div}^\text{lower} \approx \left(\frac{\alpha_1'(\tau_1)\cdot\alpha_2(\tau_2)}{\alpha(\tau)}\right)^2 \cdot e^{j4\pi f_c\left(\tau - \left(\tau_1 + \tau_2\right)\right)}
\end{equation}

最后一步是对该信号进行开平方操作，从而得到最终的无偏信号：
\begin{equation}
    H_\text{final} = \sqrt{H^2_\text{div}} \approx \frac{\alpha_1'(\tau_1)\cdot\alpha_2(\tau_2)}{\alpha(\tau)} \cdot e^{j2\pi f_c\left(\tau - \left(\tau_1 + \tau_2\right)\right)}
\end{equation}

在开平方的时候，需要注意相位的歧义性问题，即开平方的结果可能是相位$\theta$或者$\theta + \pi$。
为了解决这个问题，可以通过相位连续性的约束来选择合适的解，即假设相邻时间窗口内相位的变化较小，从而选择相位变化最小的解。
如图~\ref{fig:ambiguity}~所示，假设已经计算出$H(t_i)$，然后需要计算$H(t_{i+1})$，就选择与$H(t_i)$更接近的平方根结果作为 $H(t_{i+1})$。
这个方法在实际应用中效果良好，因为目标物体的运动通常是连续且较低速的，从而保证了相位的连续性。

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.5\linewidth]{chap03/ambiguity.pdf}
    \caption{基于相位连续性的消除歧义方法}
    \label{fig:ambiguity}
\end{figure}

\subsection{傅里叶变换引入的固定偏移}

当标签的频率发生严重漂移时，反向散射信号在傅里叶变换后的频点也可能出现移动，尤其是采用时域信号补零来提高傅里叶变换频谱分辨率时，这会导致固定的相位偏移。
假设时刻$t_1$的信号频率为$f_1$，时刻$t_2$的信号频率为$f_2$，则该相位偏移为$\pi(f_2 - f_1)(t_2 - t_1)$。

\section{感知信息提取方法}

通过上述的方法，已经成功地从接收端中提取出了可用于感知的信号。
不妨设目标的感知信号为：
\begin{equation}
    H_{\text{final}} = \sqrt{\frac{\hat{H}^\text{upper}_{B} \cdot \hat{H}^\text{lower}_{B}}{\hat{H}_E^2}} = A \cdot e^{j\theta}
\end{equation}

其中，相位信息$\theta$和幅度信息$A$分别为：
\begin{equation}
    \theta = 2 \pi f_c \left(\tau - \left(\tau_{1} + \tau_{2}\right)\right)
\end{equation}
\begin{equation}
    A = \frac{\alpha_1'(\tau_{1})\cdot\alpha_2(\tau_{2})}{\alpha(\tau)} = \mathcal{A}(\tau, \tau_{1}, \tau_{2})
\end{equation}

\subsection{相位信息转化为运动信息}

通过相位信息$\theta$，可以直接推导出目标物体反射信号的路程变化：
\begin{equation}
    \Delta d = \frac{\Delta \theta}{2 \pi f_c} \cdot c
\end{equation}

这个路程变化对应物体到收发端距离的变化减去收发端之间距离的变化，若收发端之间距离保持不变，那么该路程变化即为物体到收发端距离的变化。
然而，由于目标物体到收发端的几何位置通常无法提前确定，因此难以直接将路程变化转化为物体的具体位置变化。
另一方面，多径现象的存在也使得该转化变得更加复杂。
不过，若目标物体的运动是周期性的，仍然可以通过傅里叶变换等方法来计算出物体的运动频率。

相位卷绕现象的存在以及开平方消歧义方法的使用，将对物体运动速度作出限制：
\begin{equation}
    v_{\max} = \frac{c}{4 f_c T}
\end{equation}

\subsection{信号特征联合估计算法}

相比于相位信息，虽然幅度信息$A$由于与信号传播路程的关系更加复杂而难以直接转化为物体运动的距离信息，但是其中仍然包含了物体运动的频率信息。
因此，在处理特定类型的运动如往复运动时，可以将信号幅度信息和相位信息联合起来进行估计，从而提升感知的准确性。
本节将其建模成一个优化问题，用参数化的轨迹来逼近振幅变化$A(t)$和相位变化$\theta(t)$。

假设目标的真实轨迹具有未知频率$f$，可以将其表示如下：
\begin{equation}
    g(t; f, \alpha, \beta, \gamma) = \alpha \cos{2\pi ft} + \beta \sin{2\pi ft} + \gamma
\end{equation}

其中，$\alpha$和$\beta$分别表示参数化轨迹中余弦分量和正弦分量的振幅，$\gamma$为偏移项。
于是，优化问题形式化如下：
\begin{equation}
    \begin{aligned}
        f^* = \argmin_{f\in\mathcal{F}}
         & \left\Vert A(t)- g(t; f, \alpha_1, \beta_1, \gamma_1)\right\Vert _2^2      \\
        +
         & \left\Vert \theta(t)- g(t; f, \alpha_2, \beta_2, \gamma_2)\right\Vert _2^2
    \end{aligned}
\end{equation}

\begin{algorithm}[htbp]
    \caption{联合估计算法}
    \label{alg: joint-estimation}
    \begin{algorithmic}
        \REQUIRE 幅度变化 $A[t]$, 相位变化 $\theta[t]$, 时间戳 $[t]$, 频率搜索空间 $\mathcal{F}$
        \ENSURE 最优频率 $f^*$
        \STATE $A[t] \leftarrow normalize(A[t]), \theta[t] \leftarrow normalize(\theta[t])$
        \STATE $f^* \leftarrow 0, l^* \leftarrow \infty, n=\text{len}([t])$
        \FOR {$f \in \mathcal{F}$}
        \STATE  $\varphi[t] \leftarrow \cos{2\pi f[t]}$, $\psi[t] \leftarrow \sin{2\pi f[t]}$
        \STATE
        $
            X \leftarrow \begin{bmatrix}
                \varphi\varphi^\mathrm{T} & \varphi\psi^\mathrm{T} & \sum\varphi \\
                \varphi\psi^\mathrm{T}    & \psi\psi^\mathrm{T}    & \sum\psi    \\
                \sum\varphi               & \sum \psi              & n           \\
            \end{bmatrix}
        $
        \STATE
        $
            b_1 \leftarrow \begin{bmatrix}
                \varphi A^\mathrm{T} \\
                \psi A^\mathrm{T}    \\
                \sum A               \\
            \end{bmatrix}
        $,
        $
            b_2 \leftarrow \begin{bmatrix}
                \varphi \theta^\mathrm{T} \\
                \psi \theta^\mathrm{T}    \\
                \sum \theta               \\
            \end{bmatrix}
        $,
        \STATE $
            \begin{bmatrix}
                \alpha_1 \\
                \beta_1  \\
                \gamma_1 \\
            \end{bmatrix}
            \leftarrow
            X^{-1} b_1
        $,
        $
            \begin{bmatrix}
                \alpha_2 \\
                \beta_2  \\
                \gamma_2 \\
            \end{bmatrix}
            \leftarrow
            X^{-1} b_2
        $
        \STATE $
            \begin{aligned}
                l \leftarrow & \left\Vert A[t]- g([t]; f, \alpha_1, \beta_1, \gamma_1)\right\Vert _2^2 \\ + &\left\Vert \theta[t]- g([t], f, \alpha_2, \beta_2, \gamma_2)\right\Vert _2^2
            \end{aligned}
        $
        \IF {$l < l^*$}
        \STATE  $f^* = f, l^* = l$
        \ENDIF
        \ENDFOR
        \RETURN $f^*$
    \end{algorithmic}
\end{algorithm}

为了解决该优化问题，可以采用网格搜索方法与解析方法相结合的方法，具体算法如 算法~\ref{alg: joint-estimation}~所示。
该联合估计算法充分利用了信号的相位和振幅信息，从而可以更高效地确定目标的运动频率。
假设频率搜索空间为 $\mathcal{F}$（例如，在$0\sim1$Hz的范围内，每$0.01$Hz进行一次搜索），且信号包含$N$个啁啾符号，那么该算法的计算复杂度为$O(N|\mathcal{F}|)$，与信号长度呈线性关系。

\section{抗干扰能力分析} \label{sec:anti-interference}

由于本文提出的方法使用激励信号来消除收发端不同步引起的相位偏移，因此需要考虑激励信号受到的环境干扰如何影响最终的感知结果。
先前假设激励信号总是静态信号，但实际上感知范围内的其他运动物体也会反射激励信号，从而使激励信号出现扰动。
幸运的是，这些扰动通常比激励信号低几个数量级，从而使得干扰有限。

在自由空间传播模型中，信号的传播损耗与距离的平方成正比。
静态视距激励信号的信号强度可以表示为：
\begin{equation}
    P_{\text{LoS}} = \frac{P_t G_t G_r \lambda^2}{(4\pi)^2 d_{\text{TR}}^2}
\end{equation}

其中，$P_t$是发送端的发送功率，$G_t$和$G_r$分别是发送端和接收端的天线增益，$\lambda$是信号的波长，$d_{\text{TR}}$是发送端和接收端之间的距离。
而动态反射激励信号的信号强度可以表示为：
\begin{equation}
    P_{\text{r}} = \frac{P_t G_t G_r \lambda^2 \sigma}{(4\pi)^3 (d_{\text{T}} d_{\text{R}})^2}
\end{equation}

其中，$\sigma$是动态物体的雷达截面积，$d_{\text{T}}$和$d_{\text{R}}$分别是发送端到动态物体和动态物体到接收端的距离。
于是，动态反射激励信号与静态视距激励信号的强度比为：
\begin{equation}
    \frac{P_{\text{r}}}{P_{\text{LoS}}} = \frac{\sigma}{4\pi} \cdot \frac{d_{\text{TR}}^2}{(d_{\text{T}} d_{\text{R}})^2}
\end{equation}

\begin{figure}[htbp]
    \centering
    \includegraphics[width=0.8\linewidth]{chap03/interference_power.pdf}
    \caption{干扰强度热力图}
    \label{fig:inference-power}
\end{figure}

如图~\ref{fig:inference-power}~所示，假设发送端和接收端分别位于$(-5, 0)$和$(5, 0)$处，此时不同位置的动态物体对激励信号的干扰强度比可以表示为图中的热力图。
可以看到，只有当动态物体非常靠近收发端时，干扰强度才会显著提升，而在大部分区域内，干扰强度都远低于静态视距激励信号的强度。
例如，当动态物体距离收发端3m时，干扰强度比约为-20dB，此时，最大的信号相位误差为$\arcsin{\frac{1}{10}} \approx 0.1$弧度，最大的信号幅度误差为0.1。

在本文的实际应用中，收发端之间的距离会比图中更大，从而进一步降低干扰强度。
因此，本文提出的方法能够在一定程度上抵抗环境中的动态干扰，从而提升感知的鲁棒性。

\section{本章小结}

本章详尽地分析了基于啁啾信号的反向散射感知系统中会遇到的挑战，并提出了一系列有效的解决方案。
从信号处理流程出发，本章首先介绍了改进的啁啾信号解调方法，包括共轭解调方法和基于概率模型的相干解调方法，以提高反射信号的信噪比。
随后，针对远近效应问题，提出了基于窗函数的缓解方法，以降低强信号对弱信号的干扰，从而提取出精确的激励信号和反向散射信号。
在提取出精确的信号后，本章进一步探讨了相位偏移消除方法，分别针对收发端不同步和标签频率漂移两种情况，提出了相应的校正和误差消除方法。
具体而言，通过将反向散射信号与激励信号相除，有效地消除了由不同步引起的相位偏移；同时，利用双边带信号的特性，成功地抵消了标签频率漂移带来的误差。
最后，本章介绍了感知信息的提取方法，包括将相位信息转化为运动信息的方法，以及综合利用幅度和相位信息进行目标运动频率估计的算法。
在接下来的章节中，将进一步探讨原型系统的实现及其在实验验证中的效果。
